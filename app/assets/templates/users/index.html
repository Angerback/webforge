<div class="container">
	<div>
		<ol class="breadcrumb ms">
		  	<li><a href="/#/">Inicio</a></li>
		  	<li class="active"> Usuarios</li>
		</ol>
	</div>
	<div>
		<h1 class="question-instructions">Usuarios de la aplicación</h1>

			<!-- Modal Nuevo usuario-->
			<div id="nuevoUsuario" class="modal fade" role="dialog">
			  <div class="modal-dialog">

			    <!-- Modal content-->
			    <div class="modal-content" style ="border-radius: 0 !important;">
			      <div class="modal-header">
			        <button type="button" class="close" data-dismiss="modal">&times;</button>
			        <h4 id="nuevoUsuarioTag">Nuevo usuario</h4>
			      </div>
			      <div class="modal-body">
			      <p>FORMULARIO</p>
			        <!--<%= render 'new' %>-->

			      </div>
			    </div>

			  </div>
			</div>

			<div class="row">
					<div class="pull-left">
						<button type="button" class="btn btn-primary square" data-toggle="modal" data-target="#nuevoUsuario">Crear Usuario</button>
			</div>

			<div ng-repeat="user in users">

				<!-- Modal Ver usuario-->
				<div id="verUsuario{{user.id}}" class="modal fade" role="dialog">
					<div class="modal-dialog">

					  <!-- Modal content-->
					  <div class="modal-content" style ="border-radius: 0 !important;">
					    <div class="modal-header">
					      <button type="button" class="close" data-dismiss="modal">&times;</button>
					      <h4 id="nuevoUsuarioTag{{user.id}}">Detalle usuario</h4>
					    </div>
					   <div class="modal-body" ng-if="user.id!=''">
								<div class="row">
									<div class="col-xs-6">
										<div class="panel panel-default">
										  <div class="panel-body">
										    <h2 class="ms-h2">Información básica</h2>
										    <p>
										      <strong>Rut:</strong> {{user.rut}}
										    </p>
										    <p>
										      <strong>Correo:</strong> {{user.email}}
										    </p>
										    <p>
										      <strong>Rol:</strong> {{user.user_type}}
										    </p>
										  </div>
										</div>
									</div>
									<div class="col-xs-6" ng-if="user.tests.last">
										<div class="panel panel-default">
										  <div class="panel-body">
										    <h2 class="ms-h2">Últimas evaluaciones</h2>
										      <p>
										      <!--Revisar esto:pasarlo a angular--> 
										      <strong>Calificación en {{evaluation.name}}:</strong>
										      <%= number_with_precision(user.tests.last.grade, :precision => 1 ) %>
										      <!--Fin de objeto a revisar-->
										      </p>
										  </div>
										</div>
									</div>
								</div>

								<div>
									<button type="button" href="users#editarUsuario{{user.id}}" data-toggle="modal"  class="btn btn-primary square">Editar</button>

									<a href="" data-dismiss="modal" data-target="users#verUsuario{{user.id}}">Volver</a>
								</div>
					    </div>
					  </div>
					</div>
				</div>

				<!-- Modal Editar usuario-->
				<div id="editarUsuario{{user.id}}" class="modal fade" role="dialog">
					<div class="modal-dialog">

					  <!-- Modal content-->
					  <div class="modal-content" style ="border-radius: 0 !important;">
					      <div class="modal-header">
					        <button type="button" class="close" data-dismiss="modal">&times;</button>
					        <h4 id="nuevoUsuarioTag{{user.id}}">Editar información de {{user.name}}</h4>
					      </div>
					    <div class="modal-body" ng-if="user.id!=''">
									<div class="row">
										<div class="col-xs-12">
										  <div class="panel panel-default">
										    <div class="panel-body">
													<%= form_for(user) do |f| %>

													  <div class="field">
													    <%= f.label :name %><br>
													    <%= f.text_field :name, class: "form-control ms-input" %>
													  </div>
													  <div class="field">
													    <%= f.label :rut %><br>
													    <%= f.text_field :rut, class: "form-control ms-input" %>
													  </div>
													  <div class="field">
													    <%= f.label :email %><br>
													    <%= f.text_field :email, class: "form-control ms-input" %>
													  </div>
													  <div class="field">
													    <%= label :user_type, "Tipo de Usuario" %>
													    <%= f.select :user_type, options_for_select([["Alumno"], ["Ayudante"], ["Profesor"]]), class: "form-control" %>
												    </div>


														<div class="field onoffswitch">
													    <%= f.label :suspended, "Deshabilitar" %>
													    <%= f.check_box :suspended, checked: check_if_true(user.suspended)%>
												    </div>
												    <!-- switch para deshabilitar -->
												    <!--div class="onoffswitch">
        												<input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="myonoffswitch">
        												<label class="onoffswitch-label" for="myonoffswitch">
            												<span class="onoffswitch-inner"></span>
            												<span class="onoffswitch-switch"></span>
        												</label>
    												</div-->
										    </div>
										  </div>
										</div>
									</div>
									<div>

										<button type="button" class="btn btn-primary square" onclick="return confirm('¿Estás seguro que deseas cambiar los datos?')" data-toggle="modal">Actualizar usuario</button>

										<a href="" data-dismiss="modal" data-target="#editarUsuario{{user.id}}">Volver</a>
									</div>
					    </div>
					  </div>
					</div>
				</div>

			</div>

		<table class="table" id="tabla_resultado">
			<tr>
				<th>Nombre</th>
				<th>Rut</th>
				<th>Correo</th>
				<th>Rol</th>
				<th class="text-center" colspan="1">Operación</th>
			</tr>
			<tr ng-repeat="user in users"> 
				<td ng-if="user.suspended==true"><span class="glyphicon glyphicon-ban-circle"></span>{{user.name}}</td>
				<td ng-if="user.suspended==false">{{user.name}}</td>
				<td>{{user.rut}}</td>
				<td>{{user.email}}</td>
				<td>{{user.user_type}}</td>
				<td class="text-center">
					<a href="users#verUsuario{{user.id}}" data-toggle="modal">
					<span class="glyphicon glyphicon-eye-open"></span>
					</a>
				</td>
			</tr>	
		</table>
	</div>	
</div>